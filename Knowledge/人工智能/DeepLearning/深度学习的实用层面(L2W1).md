# 深度学习的实用层面(L2W1)

## 训练集(Train Set)/验证集(Development Set)/测试集(Test Set)
训练集用于训练神经网络
验证集(Dev Set)用于交叉验证, 选择最好的模型
在模型在Dev Set上经过充分验证后, 可以在测试集上进行无偏评估

在样本数量很少时, 例如1000, 10000个
可以使用 Train Set / Dev Set / Test Set = 0.6 / 0.2 / 0.2
或者 Train Set / Dev Set = 0.7 / 0.3
当样本数很大, 例如 100,000时, 就可以让Train Set的比例提高到98%, 甚至99.5%

如果训练集和测试集来源不同, 例如训练集是经过精细处理过的图片, 而测试集是手机拍摄的图片
则需要让Dev Set和Test Set的来源相同

在条件不满足时, 可以没有Test Set

## 偏差(Bias)/方差(Variance)

偏差Bias 通常指模型拟合不好, 例如用线性分类去分类一个复杂问题
方差Variance 通常指模型很复杂, 过度拟合, 例如用一个极其复杂的曲线分类一个简单问题

假设一个人类容易分辨的问题, 如分类猫和非猫
来源                   |  1        |   2         |   3               |   4
------------------|--------|----------|--------------|--------------
Train Set错误率  | 1%      | 15%      | 15%            | 0.5%
Dev Set错误率    | 11%      | 16%     | 30%             | 1%
评价                   | 方差高 | 偏差高 | 方差高偏差高 | 方差低偏差低

## 调教神经网络的基本步骤

1,  验证是否 High Bias ?
    Yes -> 构建更大更深的神经网络
    No -> 进入步骤2
2, 验证是否 High Variance ?
    Yes -> 增大数据量 / 正则化
    No -> Done!!!

## 正则化
当网络出现High Variance, 即过拟合时, 通常使用正则化的方法来降低拟合性
具体方法:
在成本函数中追加一项
`J(w, b) = sumL(yhat, y) + lambd / (2 * m) * Frobenius(w)`
Frobenius(w)即w的二阶范数
lambd是可调节的超参数
如果w为矩阵, 则Frobenius(w)的值为矩阵所有元素的平方和

正则化可以让w的部分项更快的接近0, 使得网络中的某些节点的权重接近0, 从而降低它们的影响
从而使较深的神经网络变得更简单(一些节点变得可以忽略不计了)

## Dropout正则化
在神经网络传播时, 随机按照一定概率扔掉一些节点, 从而使得网络变小, 降低Variance

## 其他正则化方法
### 数据拓充(Data augmentation)
可以把原来的图片进行水平翻转, 从而使训练集数量翻倍
可以将原图的一部分扣出来, 旋转一个较小的角度, 增加训练集数量
可以使用滤镜将图像进行轻微扭曲

### Early Stopping
提早结束迭代
在进行神经网络训练时, 有时会发生损失函数Cost在不断迭代的过程中, 先下降再上升, 
在下降到最低点附近终止迭代也许结果更好

## 归一化输入
1, 第一步
```
u = sum(xi) / m
x := x - u # 输入减去所有输入的均值, 使输入以0为中心
```
2, 第二步
```
a = sum(xi^2) / m
x /= a^2
```

## 梯度消失和梯度爆炸
在神经网络训练时, 有时会出现梯度指数级增加或减小
暂时的解决方案:
试过使用Relu作为激活函数, 可以在初始化W时, 乘`sqrt(2 / n ^ (l - 1))`
而tanh作为激活函数时, 在初始化W时, 乘`sqrt(1 / n ^ (l - 1))`效果更好

## 梯度检查
在调试神经网络时, 计算出一个梯度时, 
成本函数`J(x1, x2 ... xn)`对于xi的偏导数, 
大致等于`[J(x1, x2, ..., xi + e, ..., xn) - J(x1, x2, ..., xi - e, ..., xn)] / (2 * e)`
其中e是一个比较小的量, 例如`10 ^ (-7)`
可以用这个方法来验证程序有误bug





